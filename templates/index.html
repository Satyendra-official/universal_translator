<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Universal Translator</title>
    <link rel="stylesheet" href="../static/styles.css">
    <script>
        // Function to show and hide inputs based on the selected mode
        function toggleInputMode() {
            const inputMode = document.querySelector('input[name="input_mode"]:checked').value;

            // Hide all input fields first
            document.getElementById('text_input').style.display = 'none';
            document.getElementById('audio_input').style.display = 'none';
            document.getElementById('video_input').style.display = 'none';

            // Show the selected input field
            if (inputMode === 'text') {
                document.getElementById('text_input').style.display = 'block';
            } else if (inputMode === 'audio') {
                document.getElementById('audio_input').style.display = 'block';
            } else if (inputMode === 'video') {
                document.getElementById('video_input').style.display = 'block';
            }
        }

        // Initialize the page with the correct input field visibility
        window.onload = function() {
            toggleInputMode(); // Ensure the right input field is visible when the page loads
        };
    </script>
</head>
<body>
    <h2>Universal Translator üåê</h2>
    <form method="POST" enctype="multipart/form-data">
        <label>Select Input Mode:</label><br>
        <input type="radio" name="input_mode" value="text" checked onclick="toggleInputMode()"> Text
        <input type="radio" name="input_mode" value="audio" onclick="toggleInputMode()"> Audio
        <input type="radio" name="input_mode" value="video" onclick="toggleInputMode()"> Video<br><br>

        <!-- Text Input -->
        <div id="text_input">
            <textarea name="text" rows="4" cols="50" placeholder="Enter text to translate...">{{ request.form['text'] if request.form['input_mode'] == 'text' else '' }}</textarea><br><br>
        </div>

        <!-- Audio Input (file upload) -->
        <div id="audio_input" style="display:none;">
            <input type="file" name="audio_file" accept="audio/*"><br><br>
        </div>

        <!-- Video Input (file upload) -->
        <div id="video_input" style="display:none;">
            <input type="file" name="video_file" accept="video/*"><br><br>
        </div>

        <label>Target Language:</label>
        <select name="target_lang">
            {% for code, name in languages.items() %}
                <option value="{{ code }}" {% if code == request.form['target_lang'] %}selected{% endif %}>{{ name }}</option>
            {% endfor %}
        </select><br><br>

        <input type="submit" value="Translate">
    </form>

    {% if translated_text %}
        <h3>Translation:</h3>
        <p>{{ translated_text }}</p>
        {% if audio_file_path %}
            <h4>Translated Audio:</h4>
            <audio controls>
                <source src="{{ url_for('static', filename='translated_audio.mp3') }}" type="audio/mpeg">
            </audio>
        {% endif %}
    {% endif %}
</body>
</html>
